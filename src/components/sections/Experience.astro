---
import Section from "../Section.astro"

import { work } from "@cv"
---

<Section title="Work Experience">
  <ul>
    {
      work.map(
        ({ name, startDate, endDate, position, summary, highlights, skills, url }) => {
            const startYear = new Date(startDate).getFullYear()
            const startMonth = new Date(startDate).toLocaleString('en-US', { month: 'short' })
            const endYear = endDate != null ? new Date(endDate).getFullYear() : "Present"
            const endMonth = endDate != null ? new Date(endDate).toLocaleString('en-US', { month: 'short' }) : "Present" 
            const years = `${startMonth} ${startYear} - ${endMonth} ${endYear}`

  return (
    <li>
      <article>
        <header>
          <div>
            <h3>
              <a href={url} title={`Ver ${name}`} target="_blank">
                {name}
              </a>
            </h3>
            <h4>{position}</h4>
          </div>

          <time>{years}</time> <!-- years variable now includes months -->
        </header>

        <footer>
          <p>{summary}</p>
            <ul>
                {
                skills?.map((skill, index) => (
                    <li key={index}>{skill}</li>
                ))
                }
            </ul>
        </footer>
      </article>
    </li>
  )
}
      )
    }
  </ul>
</Section>

<style>
  ul {
    display: flex;
    flex-direction: column;
    gap: 32px;
  }

  article h3 {
    font-weight: 500;
    color: #111;
  }

  article a {
    color: #111;
  }

  article a:hover {
    text-decoration: underline;
  }

  article h4 {
    color: #222;
    font-weight: 400;
  }

  header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 4px;
  }

  time {
    color: #555;
    font-size: 0.85rem;
    min-width: 102px;
    padding-top: .6rem;
  }

  footer ul {
    list-style: none; 
    flex-direction: row;
    padding: 0; 
    display: flex; 
    flex-wrap: wrap; 
    gap: 10px; 
}

footer ul li {
    background-color: #f2f2f2; 
    padding: 5px 10px; 
    border-radius: 5px; 
    font-size: 0.7rem; 
    font-weight: 500; 
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); 
    white-space: nowrap; 
}

  @media (width <= 700px) {
    time {
      text-align: right;
      font-size: small;
      max-width: 40vw;
      padding-top: .3rem;
    }

    article h3 {
    font-weight: 500;
    font-size: large;
    color: #111;
  }
  }
</style>